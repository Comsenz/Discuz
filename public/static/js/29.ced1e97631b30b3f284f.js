(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"1BLf":function(e,t,n){"use strict";n.r(t);var i=n("S6fc"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t.default=o.a},"3AWV":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n("QbLZ"));n("iUmJ");var o=a(n("zkMY"));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)({name:"login-sign-up-footer"},o.default)},AIdQ:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"bind-phone-box"},[n("BindPhoneHeader"),e._v(" "),n("main",{staticClass:"bind-phone-main"},[e._m(0),e._v(" "),n("div",{staticClass:"login-module-form"},[n("van-cell-group",[n("van-field",{attrs:{label:"手机号",placeholder:"请输入您的手机号"},model:{value:e.phoneNum,callback:function(t){e.phoneNum=t},expression:"phoneNum"}}),e._v(" "),n("van-field",{attrs:{center:"",clearable:"",label:"验证码",placeholder:"请输入验证码"},model:{value:e.verifyNum,callback:function(t){e.verifyNum=t},expression:"verifyNum"}},[n("van-button",{class:{grayBg:e.isGray},attrs:{slot:"button",size:"small",type:"default"},on:{click:e.sendSmsCode},slot:"button"},[e._v(e._s(e.btnContent))])],1)],1)],1),e._v(" "),n("div",{staticClass:"bind-phone-btn"},[n("van-button",{attrs:{type:"primary"},on:{click:function(t){return e.bindPhone()}}},[e._v("提交")])],1)]),e._v(" "),n("BindPhoneFooter")],1)},o=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-module-title-box"},[t("h2",{staticClass:"login-module-title"},[this._v("绑定手机号")])])}];n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},NdMT:function(e,t,n){},PvCI:function(e,t,n){"use strict";n.r(t);var i=n("AIdQ"),o=n("1BLf");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);var s=n("KHd+"),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);t.default=r.exports},Ra63:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("footer",{staticClass:"login-user-footer"},["login-user"===e.pageName||"login-phone"===e.pageName?[e.qcloudSms?n("span",{on:{click:e.retrieveClick}},[e._v("忘记密码？找回")]):e._e(),e._v(" "),e.registerClose&&e.qcloudSms?n("i"):e._e(),e._v(" "),e.registerClose?n("span",{on:{click:e.signUpClick}},[e._v("注册")]):e._e()]:"wx-login-bd"===e.pageName?[n("span",{on:{click:e.wxSignUpBdClick}},[e._v("没有账号？注册，绑定微信新账号")])]:"wx-sign-up-bd"===e.pageName?[n("span",{on:{click:e.wxLoginBdClick}},[e._v("已有账号？登录，微信绑定账号")])]:"sign-up"===e.pageName?[n("span",{on:{click:e.loginClick}},[e._v("已有账号立即登录")])]:"bind-phone"===e.pageName?[n("span",{on:{click:e.homeClick}},[e._v(e._s("pay"===e.siteMode?"跳过，进入支付费用":"跳过，进入首页"))])]:(e.pageName,[n("span")])],2)},o=[];n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}))},S6fc:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n("QbLZ"));n("NdMT"),n("iUmJ");var o=a(n("d8De"));function a(e){return e&&e.__esModule?e:{default:e}}t.default=(0,i.default)({name:"bind-phone-view"},o.default)},UjaL:function(e,t,n){"use strict";n.r(t);var i=n("Ra63"),o=n("pz4+");for(var a in o)"default"!==a&&function(e){n.d(t,e,(function(){return o[e]}))}(a);var s=n("KHd+"),r=Object(s.a)(o.default,i.a,i.b,!1,null,null,null);t.default=r.exports},d8De:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=r(n("JZuw")),o=r(n("UjaL")),a=r(n("VVfg")),s=r(n("YSgG"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{phoneNum:"",verifyNum:"",btnContent:"获取验证码",time:1,disabled:!1,login:"login",insterVal:"",isGray:!1,siteMode:""}},methods:{sendSmsCode:function(){var e=this,t=this.phoneNum;t?(/^((13|14|15|17|18)[0-9]{1}\d{8})$/.test(t)||this.$toast("您输入的手机号码不合法，请重新输入"),this.appFetch({url:"sendSms",method:"post",data:{data:{attributes:{mobile:this.phoneNum,type:"bind"}}}}).then((function(t){t.errors?e.$toast.fail(t.errors[0].code):(e.insterVal=t.data.attributes.interval,e.time=e.insterVal,e.timer())}))):this.$toast("请输入手机号码")},timer:function(){if(this.time>1){this.time--,this.btnContent=this.time+"s后重新获取",this.disabled=!0;var e=setTimeout(this.timer,1e3);this.isGray=!0}else 1==this.time&&(this.btnContent="获取验证码",clearTimeout(e),this.disabled=!1,this.isGray=!1)},bindPhone:function(){var e=this;this.appFetch({url:"smsVerify",method:"post",data:{data:{attributes:{mobile:this.phoneNum,code:this.verifyNum,type:"bind"}}}}).then((function(t){e.$router.push({path:"/circle"}),t.errors?e.$toast.fail(t.errors[0].code):t.errors||("pay"===e.siteMode?e.$router.push({path:"pay-the-fee"}):"public"===e.siteMode&&e.$router.push({path:"/"}))})).catch((function(e){console.log(e)}))},getUsers:function(e){var t=this;return(0,s.default)({url:"users",method:"get",splice:"/"+e,headers:{Authorization:"Bearer "+a.default.getLItem("Authorization")},data:{include:["groups"]}}).then((function(e){if(!e.errors)return console.log(e),e.readdata._data.mobile;t.$toast.fail(e.errors[0].code)})).catch((function(e){console.log(e)}))}},created:function(){var e=this;this.siteMode=a.default.getLItem("siteInfo")._data.set_site.site_mode;var t=a.default.getLItem("tokenId");this.getUsers(t).then((function(t){""!==t&&e.$router.push("bind-new-phone")}))},components:{BindPhoneHeader:i.default,BindPhoneFooter:o.default}}},"pz4+":function(e,t,n){"use strict";n.r(t);var i=n("3AWV"),o=n.n(i);for(var a in i)"default"!==a&&function(e){n.d(t,e,(function(){return i[e]}))}(a);t.default=o.a},zkMY:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=n("VVfg"),a=(i=o)&&i.__esModule?i:{default:i};t.default={data:function(){return{pageName:"login",siteMode:"",registerClose:!0,qcloudSms:!0}},methods:{retrieveClick:function(){this.$router.push("retrieve-pwd")},signUpClick:function(){this.$router.push("sign-up")},wxSignUpBdClick:function(){this.$router.push("/wx-sign-up-bd")},wxLoginBdClick:function(){this.$router.push("/wx-login-bd")},loginClick:function(){this.$router.push("/login-user")},homeClick:function(){switch(this.siteMode){case"pay":this.$router.push({path:"pay-the-fee"});break;case"public":this.$router.push({path:"/"});break;default:console.log("参数错误，请重新刷新页面")}},getForum:function(){var e=this;this.appFetch({url:"forum",method:"get",data:{}}).then((function(t){console.log(t),e.siteMode=t.readdata._data.set_site.site_mode,e.registerClose=t.readdata._data.set_reg.register_close,e.qcloudSms=t.readdata._data.qcloud.qcloud_sms,a.default.setLItem("siteInfo",t.readdata)})).catch((function(e){console.log(e)}))}},created:function(){this.pageName=this.$router.history.current.name,this.getForum()}}}}]);