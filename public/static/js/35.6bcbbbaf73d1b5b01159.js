(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{"3AWV":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(i("QbLZ"));i("iUmJ");var n=a(i("zkMY"));function a(t){return t&&t.__esModule?t:{default:t}}e.default=(0,o.default)({name:"login-sign-up-footer"},n.default)},"5JD/":function(t,e,i){"use strict";i.r(e);var o=i("HE2v"),n=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e.default=n.a},HE2v:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a(i("QbLZ"));i("NdMT"),i("iUmJ");var n=a(i("SHGB"));function a(t){return t&&t.__esModule?t:{default:t}}e.default=(0,o.default)({name:"login-view"},n.default)},NdMT:function(t,e,i){},Ra63:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("footer",{staticClass:"login-user-footer"},["login-user"===t.pageName||"login-phone"===t.pageName?[t.qcloudSms?i("span",{on:{click:t.retrieveClick}},[t._v("忘记密码？找回")]):t._e(),t._v(" "),t.registerClose&&t.qcloudSms?i("i"):t._e(),t._v(" "),t.registerClose?i("span",{on:{click:t.signUpClick}},[t._v("注册")]):t._e()]:"wx-login-bd"===t.pageName?[i("span",{on:{click:t.wxSignUpBdClick}},[t._v("没有账号？注册，绑定微信新账号")])]:"wx-sign-up-bd"===t.pageName?[i("span",{on:{click:t.wxLoginBdClick}},[t._v("已有账号？登录，微信绑定账号")])]:"sign-up"===t.pageName?[i("span",{on:{click:t.loginClick}},[t._v("已有账号立即登录")])]:"bind-phone"===t.pageName?[i("span",{on:{click:t.homeClick}},[t._v(t._s("pay"===t.siteMode?"跳过，进入支付费用":"跳过，进入首页"))])]:(t.pageName,[i("span")])],2)},n=[];i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return n}))},SHGB:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=u(i("QbLZ")),n=u(i("JZuw")),a=u(i("UjaL")),s=u(i("VVfg")),r=i("L2JU");function u(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{userName:"",password:"",userId:"2",btnLoading:!1,wxLoginShow:!0,isOne:!1,siteMode:"",phoneStatus:"",wxHref:"",isPC:!1,isCodeState:0,wxStatus:""}},computed:(0,r.mapState)({status:function(t){return t.appSiteModule.status}}),mounted:function(){},methods:(0,o.default)({},(0,r.mapMutations)({setStatus:"appSiteModule/SET_STATUS",setOpenId:"appSiteModule/SET_OPENID"}),{loginClick:function(){var t=this;this.setStatus("啊啦啦啦"),this.btnLoading=!0,this.appFetch({url:"login",method:"post",data:{data:{attributes:{username:this.userName,password:this.password}}}}).then((function(e){if(t.btnLoading=!1,e.errors)e.errors[0].detail?t.$toast.fail(e.errors[0].code+"\n"+e.errors[0].detail[0]):t.$toast.fail(e.errors[0].code);else{t.$toast.success("登录成功");var i=e.data.attributes.access_token,o=e.data.id,n=e.data.attributes.refresh_token;s.default.setLItem("Authorization",i),s.default.setLItem("tokenId",o),s.default.setLItem("refreshToken",n),t.getUsers(o).then((function(e){if(e.errors){var i=t.appCommonH.errorHandling(e.errors,!0);t.$toast.fail(i[0].errorDetail)}else if(e.readdata._data.paid){s.default.setLItem("foregroundUser",e.data.attributes.username);var o=s.default.getSItem("beforeVisiting");o?t.$router.push({path:o}):t.$router.push({path:"/"})}else"pay"===t.siteMode?t.$router.push({path:"pay-circle-login"}):"public"===t.siteMode&&t.$router.push({path:"/"})}))}})).catch((function(t){}))},loginWxClick:function(){var t=this;this.getWxLogin().then((function(e){e.errors?t.$toast.fail(e.errors[0].code):window.location.href=e.readdata._data.location}))},loginPhoneClick:function(){this.$router.push({path:"/login-phone"})},getForum:function(){var t=this;this.appFetch({url:"forum",method:"get",data:{}}).then((function(e){t.phoneStatus=e.readdata._data.qcloud.qcloud_sms,t.siteMode=e.readdata._data.set_site.site_mode,s.default.setLItem("siteInfo",e.readdata)})).catch((function(t){}))},getUsers:function(t){var e=this;return this.appFetch({url:"users",method:"get",splice:"/"+t,headers:{Authorization:"Bearer "+s.default.getLItem("Authorization")},data:{include:["groups"]}}).then((function(t){if(!t.errors)return t;e.$toast.fail(t.errors[0].code)})).catch((function(t){}))},getWxLogin:function(){return this.appFetch({url:"wxLogin",method:"get",data:{}}).then((function(t){return t})).catch((function(t){}))}}),created:function(){var t=this.appCommonH.isWeixin().isWeixin,e=this.appCommonH.isWeixin().isPhone;!0===t||(!0===e?(this.wxLoginShow=!1,this.isOne=!0):this.isPC=!0),this.getForum()},components:{LoginHeader:n.default,LoginFooter:a.default}}},UjaL:function(t,e,i){"use strict";i.r(e);var o=i("Ra63"),n=i("pz4+");for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);var s=i("KHd+"),r=Object(s.a)(n.default,o.a,o.b,!1,null,null,null);e.default=r.exports},lEHL:function(t,e,i){"use strict";i.r(e);var o=i("zVKz"),n=i("5JD/");for(var a in n)"default"!==a&&function(t){i.d(e,t,(function(){return n[t]}))}(a);var s=i("KHd+"),r=Object(s.a)(n.default,o.a,o.b,!1,null,null,null);e.default=r.exports},"pz4+":function(t,e,i){"use strict";i.r(e);var o=i("3AWV"),n=i.n(o);for(var a in o)"default"!==a&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e.default=n.a},zVKz:function(t,e,i){"use strict";var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login-user-box"},[i("LoginHeader"),t._v(" "),i("main",{staticClass:"login-user-box-main"},[t._m(0),t._v(" "),i("form",{staticClass:"user-login-form login-module-form"},[i("van-cell-group",[i("van-field",{attrs:{clearable:"",label:"用户名",placeholder:"请输入您的用户名"},model:{value:t.userName,callback:function(e){t.userName=e},expression:"userName"}}),t._v(" "),i("van-field",{attrs:{type:"password",clearable:"",label:"密码",placeholder:"请填写密码"},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}})],1)],1),t._v(" "),i("div",{staticClass:"login-user-btn"},[i("van-button",{attrs:{type:"primary",loading:t.btnLoading,"loading-text":"登录中..."},on:{click:t.loginClick}},[t._v("登录")])],1),t._v(" "),i("div",{staticClass:"login-user-method"},[i("div",{staticClass:"login-user-method-box"},[i("van-divider",{directives:[{name:"show",rawName:"v-show",value:t.phoneStatus||t.wxLoginShow,expression:"phoneStatus ||  wxLoginShow"}]},[t._v("其他登录方式")])],1),t._v(" "),i("div",{staticClass:"login-user-method-icon"},[i("div",{staticClass:"login-user-method-icon-box",class:{justifyCenter:t.isOne}},[t.phoneStatus?i("i",{staticClass:"login-user-method-icon-ring iconfont",on:{click:t.loginPhoneClick}},[i("span",{staticClass:"icon iconfont icon-shouji",staticStyle:{color:"rgba(136, 136, 136, 1)"}})]):t._e(),t._v(" "),i("i",{directives:[{name:"show",rawName:"v-show",value:t.wxLoginShow,expression:"wxLoginShow"}],staticClass:"login-user-method-icon-ring iconfont",on:{click:t.loginWxClick}},[i("span",{staticClass:"icon iconfont icon-weixin",staticStyle:{color:"rgba(136, 136, 136, 1)"}})])])])])]),t._v(" "),i("LoginFooter")],1)},n=[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"login-user-title-box login-module-title-box"},[e("p",{staticClass:"login-user-title-p login-module-title"},[this._v("用户名登录")])])}];i.d(e,"a",(function(){return o})),i.d(e,"b",(function(){return n}))},zkMY:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,n=i("VVfg"),a=(o=n)&&o.__esModule?o:{default:o};e.default={data:function(){return{pageName:"login",siteMode:"",registerClose:!0,qcloudSms:!0}},methods:{retrieveClick:function(){this.$router.push("retrieve-pwd")},signUpClick:function(){this.$router.push("sign-up")},wxSignUpBdClick:function(){this.$router.push("/wx-sign-up-bd")},wxLoginBdClick:function(){this.$router.push("/wx-login-bd")},loginClick:function(){this.$router.push("/login-user")},homeClick:function(){switch(this.siteMode){case"pay":this.$router.push({path:"pay-the-fee"});break;case"public":this.$router.push({path:"/"})}},getForum:function(){var t=this;this.appFetch({url:"forum",method:"get",data:{}}).then((function(e){t.siteMode=e.readdata._data.set_site.site_mode,t.registerClose=e.readdata._data.set_reg.register_close,t.qcloudSms=e.readdata._data.qcloud.qcloud_sms,a.default.setLItem("siteInfo",e.readdata)})).catch((function(t){}))}},created:function(){this.pageName=this.$router.history.current.name,this.getForum()}}}}]);