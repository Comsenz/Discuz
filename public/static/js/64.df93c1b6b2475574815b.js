(window.webpackJsonp=window.webpackJsonp||[]).push([[64],{"30Eu":function(e,t,a){"use strict";var s=a("Psoq");a.n(s).a},"4psX":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r=i(a("14Xm")),n=i(a("D3Ub"));function i(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{result:[],checkList:[],userList:[],choiceShow:!1,checkOperaStatus:!1,choList:[],searchName:"",userParams:{"filter[name]":"","page[limit]":15,"page[number]":1},userLoadMoreStatus:!1,userLoadMorePageChange:!1,choiceRes:{attributes:{name:"选择操作"}},loading:!1,finished:!1,isLoading:!1,pageSize:"",pageIndex:""}},created:(s=(0,n.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOperaType();case 2:this.handleSearch();case 3:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),methods:{toggle:function(e){var t=this.userList.length;if(0!==t){for(var a=[],s=0;s<t;s++){this.userList[s]._data.id===e&&(this.userList[s].checkStatus=!this.userList[s].checkStatus),this.userList[s].checkStatus&&a.push(this.userList[s]._data.username)}this.result=a}},showChoice:function(){this.choiceShow=!this.choiceShow},setSelectVal:function(e){this.choiceShow=!1,this.checkOperaStatus=!0,this.choiceRes=e},handleSearch:function(e){if(e){var t=e.target.value;this.searchName=t}else this.searchName="";this.userParams={"filter[name]":this.searchName,"page[limit]":15,"page[number]":1},this.getSearchValUserList(!0)},getSearchValUserList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,n.default)(r.default.mark((function a(){var s,n;return r.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.appFetch({method:"get",url:"users",data:e.userParams});case 3:s=a.sent,t&&(e.userList=[]),e.userList=e.userList.concat(s.readdata).map((function(e,t){var a=e;return a.checkStatus=!1,a})),console.log(e.userList,"userList"),e.userLoadMoreStatus=s.length>=e.userParams["page[limit]"],a.next=15;break;case 10:a.prev=10,a.t0=a.catch(0),console.error(a.t0,"membersManagementCon.js getSearchValUserList"),n=e.userParams["page[number]"],e.userLoadMorePageChange&&e.userParams["page[number]"]>1&&(e.userParams["page[number]"]=n-1);case 15:return a.prev=15,e.userLoadMorePageChange=!1,a.finish(15);case 18:case"end":return a.stop()}}),a,e,[[0,10,15,18]])})))()},getOperaType:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.appFetch({url:"groups",method:"get"});case 3:a=t.sent,e.choList=a.data,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0,"membersManagementCon.js getOperaType");case 10:return t.prev=10,t.finish(10);case 12:case"end":return t.stop()}}),t,e,[[0,7,10,12]])})))()},handleSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a,s,n,i;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.checkOperaStatus){t.next=4;break}return e.$toast("未选择操作类型"),t.abrupt("return");case 4:if(0!==e.result.length){t.next=7;break}return e.$toast("未选择用户"),t.abrupt("return");case 7:for(a=[],s=e.choiceRes.id,n=0,i=e.userList.length;n<i;n++)e.userList[n].checkStatus&&a.push({attributes:{id:e.userList[n]._data.id,groupId:s}});return t.next=12,e.appFetch({url:"users",method:"PATCH",data:{data:a}});case 12:e.getSearchValUserList(!0),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(0),console.error(t.t0,"handleSubmit error"),e.$toast("修改成员状态失败");case 19:case"end":return t.stop()}}),t,e,[[0,15]])})))()},handleLoadMoreUser:function(){this.userParams["page[number]"]++,this.userLoadMorePageChange=!0,this.getSearchValUserList()},onLoad:function(){var e=this;this.appFetch({url:"users",method:"get",data:{}}).then((function(t){e.pageSize=t.meta.threadCount,e.pageIndex=t.meta.pageCount,e.userList=t.readdata,e.loading=!1,e.userList.length>=e.pageSize&&(e.finished=!0),console.log(e.finished,"00000000000000000000")}))},onRefresh:function(){var e=this;setTimeout((function(){e.handleSearch().then((function(){e.$toast("刷新成功"),e.isLoading=!1,e.finished=!0}))}),200)}},mounted:function(){},beforeRouteLeave:function(e,t,a){}}},Arqs:function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"foueHeadBox"},[a("div",{staticClass:"fourHeader"},[a("span",{staticClass:"icon iconfont icon-back headBack"}),e._v(" "),a("h1",{staticClass:"headTit"},[e._v(e._s(e.$route.meta.title))])]),e._v(" "),a("div",{staticClass:"serBox"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.searchName,expression:"searchName"}],staticClass:"serInp",attrs:{type:"text",name:"",placeholder:"搜索"},domProps:{value:e.searchName},on:{input:[function(t){t.target.composing||(e.searchName=t.target.value)},e.handleSearch]}}),e._v(" "),a("i",{directives:[{name:"show",rawName:"v-show",value:""===e.searchName,expression:"searchName === ''"}],staticClass:"icon iconfont icon-search"})])]),e._v(" "),a("div",{staticClass:"searchRes memberCheckList"},[a("van-checkbox-group",{model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("van-cell-group",e._l(e.userList,(function(t){return a("van-cell",{key:t._data.username,staticClass:"resUser",attrs:{clickable:""},on:{click:function(a){return e.toggle(t._data.id)}}},[a("img",{staticClass:"resUserHead",attrs:{src:t._data.avatarUrl,alt:""}}),e._v(" "),a("div",{staticClass:"resUserDet"},[a("span",{staticClass:"resUserName"},[e._v(e._s(t._data.username))]),e._v(" "),a("span",{staticClass:"userRole"},[e._v(e._s(t.groups[0]&&t.groups[0]._data.name))]),e._v(" "),a("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"memberCheck",attrs:{slot:"right-icon",name:t._data.username},slot:"right-icon"})],1)])})),1)],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.userLoadMoreStatus,expression:"userLoadMoreStatus"}],staticClass:"searchMore",on:{click:e.handleLoadMoreUser}},[a("i",{staticClass:"icon iconfont icon-search"}),e._v("\n\t\t\t\t打开更多用户\n\t\t\t")])],1),e._v(" "),a("div",{staticClass:"manageFootFixed"},[a("div",{staticClass:"operaCho"},[a("div",{staticClass:"operaWo",on:{click:e.showChoice}},[a("span",[e._v(e._s(e.choiceRes.attributes.name))]),e._v(" "),a("i",{staticClass:"icon iconfont icon-choice-item"})]),e._v(" "),e.choiceShow?a("ul",{staticClass:"operaChoList"},e._l(e.choList,(function(t){return a("li",{key:t.id,staticClass:"operaChoLi",on:{click:function(a){return a.stopPropagation(),e.setSelectVal(t)}}},[e._v(e._s(t.attributes.name))])})),0):e._e()]),e._v(" "),a("button",{staticClass:"checkSubmit",on:{click:e.handleSubmit}},[e._v("提交")])])])},r=[];a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}))},NrFY:function(e,t,a){"use strict";a.r(t);var s=a("Arqs"),r=a("fKpU");for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("30Eu");var i=a("KHd+"),c=Object(i.a)(r.default,s.a,s.b,!1,null,"3fbef7e1",null);t.default=c.exports},Psoq:function(e,t,a){},"Y+eA":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(a("QbLZ")),r=n(a("4psX"));function n(e){return e&&e.__esModule?e:{default:e}}a("E2jd"),t.default=(0,s.default)({name:"managementCirclesView",components:{}},r.default)},fKpU:function(e,t,a){"use strict";a.r(t);var s=a("Y+eA"),r=a.n(s);for(var n in s)"default"!==n&&function(e){a.d(t,e,(function(){return s[e]}))}(n);t.default=r.a}}]);