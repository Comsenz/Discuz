(window.webpackJsonp=window.webpackJsonp||[]).push([[53,69],{"+1ub":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.autoTextarea=function(t,e,o,i){e=e||0;var n=!!document.getBoxObjectFor||"mozInnerScreenX"in window,a=!!window.opera&&!!window.opera.toString().indexOf("Opera"),s=function(e,o){t.addEventListener?t.addEventListener(e,o,!1):t.attachEvent("on"+e,o)},r=t.currentStyle?function(e){var o=t.currentStyle[e];if("height"===e&&1!==o.search(/px/i)){var i=t.getBoundingClientRect();return i.bottom-i.top-parseFloat(r("paddingTop"))-parseFloat(r("paddingBottom"))+"px"}return o}:function(e){return getComputedStyle(t,null)[e]},c=parseFloat(r("height"));t.style.resize="none";var l=function(){var s,l,u=0,d=t.style;t._length!==t.value.length&&(t._length=t.value.length,n||a||(u=parseInt(r("paddingTop"))+parseInt(r("paddingBottom"))),s=document.body.scrollTop||document.documentElement.scrollTop,t.style.height=c+"px",t.scrollHeight>c&&(o&&t.scrollHeight>o?(l=o-u,d.overflowY="auto"):(l=t.scrollHeight-u,d.overflowY="hidden"),d.height=l+e+"px",s+=parseInt(d.height)-t.currHeight,document.body.scrollTop=s,document.documentElement.scrollTop=s,t.currHeight=parseInt(d.height),i(parseInt(d.height))))};s("propertychange",l),s("input",l),s("focus",l),l()},e.debounce=function(t,e){var o=void 0;return function(){for(var i=this,n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];o&&clearTimeout(o),o=setTimeout((function(){t.apply(i,a)}),e||500)}}},"6GI9":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n,a=o("YEIV"),s=(i=a)&&i.__esModule?i:{default:i};e.default=(n={data:function(){return{active:0,faceIndex:0}},props:{faceData:{type:Array}},created:function(){},computed:{faces:function(){for(var t=this.faceData,e=(this.faceIndex,t),o=0,i=[];28*o<e.length;)i.push(e.slice(28*o,28*(o+1))),o+=1;return i},scrollWidth:function(){return this.faces.length*document.body.clientWidth},scrollPosition:function(){return this.active*document.body.clientWidth}},mounted:function(){var t=this,e=this.$refs.faceContent,o=0,i=0;e.ontouchstart=function(t){o=t.targetTouches[0].pageX},e.ontouchend=function(e){(i=e.changedTouches[0].pageX)-o>50?0!==t.active&&t.active--:i-o<-50&&t.active!==t.faces.length-1&&t.active++}}},(0,s.default)(n,"created",(function(){})),(0,s.default)(n,"methods",{getUrlCode:function(){var t=this;this.code=this.$utils.getUrlKey("code"),alert(code),this.appFetch({url:"weixin",method:"get",data:{code:this.code}}).then((function(t){alert(65756765)}),(function(e){100004==e.errors[0].status&&t.$router.go(-1)}))},loginWxClick:function(){this.$router.push({path:"/wx-login-bd"})},loginPhoneClick:function(){this.$router.push({path:"/login-phone"})},onFaceClick:function(t){this.$emit("onFaceChoose",t)}}),n)},"QuT+":function(t,e,o){"use strict";o.r(e);var i=o("egL5"),n=o("iN0f");for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);var s=o("KHd+"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);e.default=r.exports},SDcr:function(t,e,o){"use strict";o.r(e);var i=o("j2JY"),n=o("uwTP");for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);var s=o("KHd+"),r=Object(s.a)(n.default,i.a,i.b,!1,null,null,null);e.default=r.exports},cIj4:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n=c(o("YEIV")),a=o("ULRk"),s=o("+1ub"),r=c(o("6NK7"));function c(t){return t&&t.__esModule?t:{default:t}}var l=parseFloat(document.documentElement.style.fontSize);e.default={data:function(){return{headerTitle:"回复主题",showFacePanel:!1,keyboard:!1,replyText:"",keywordsMax:1e3,footMove:!1,faceData:[],fileList:[],uploadShow:!1,replyId:"",themeId:"",isWeixin:!1,isPhone:!1}},created:function(){this.isWeixin=r.default.isWeixin().isWeixin,this.isPhone=r.default.isWeixin().isPhone;var t=this.$route.params.replyQuote,e=this.$route.params.replyId,o=this.$route.params.themeId;this.replyText=e&&t?'<blockquote class="quoteCon">'+t+"</blockquote>":"",this.replyId=e,this.themeId=o},mounted:function(){var t=this;this.$nextTick((function(){var e=t.$refs.textarea;e.focus();var o=300;e&&(0,s.autoTextarea)(e,5,0,(function(t){if((t+=20)!==o){o=t}}))})),1!=this.isWeixin&&1!=this.isPhone&&this.limitWidth()},beforeDestroy:function(){a.Bus.$off("message")},methods:(i={limitWidth:function(){document.getElementById("post-topic-footer").style.width="640px";var t=window.innerWidth;document.getElementById("post-topic-footer").style.marginLeft=(t-640)/2+"px"},handleFile:function(t){var e=new FormData;e.append("file",t.file),e.append("isGallery",!0),this.uploaderEnclosure(e)},handleFileUp:function(t){var e=t.target.files[0],o=new FormData;o.append("file",e),o.append("isGallery",!0),this.uploaderEnclosure(o,!0),this.uploadShow=!0},deleteFile:function(){this.fileList.length<=1&&(this.uploadShow=!1)},uploaderEnclosure:function(t,e){var o=this;this.appFetch({url:"attachment",method:"post",data:t}).then((function(t){e&&o.fileList.push({url:t.readdata._data.fileName})})).catch((function(t){o.$message("失败")}))},clearKeywords:function(){this.keywords="",this.list=[];var t=this.$refs.textarea,e=40/l;t.style.height=e+"rem",e=60/l,t.focus()},searchChange:(0,s.debounce)((function(){if(this.keywords&&this.keywords.trim())this.keywords;else this.list=[]})),handleFaceChoose:function(t){console.log(t);var e=this.replyText,o=this.$refs.textarea,i=o.selectionStart,n=o.selectionEnd,a=e.substring(0,i)+t+e.substring(n,e.length);this.replyText=a,o.setSelectionRange&&setTimeout((function(){var e=i+t.length;o.setSelectionRange(e,e)}),0)},addExpression:function(){var t=this;this.keyboard=!this.keyboard,this.appFetch({url:"emojis",method:"get",data:{include:""}}).then((function(e){t.faceData=e.readdata})),this.showFacePanel=!this.showFacePanel,this.footMove=!this.footMove},backClick:function(){this.$router.go(-1)},dClick:function(){this.showPopup=!0},onConfirm:function(t,e){console.log(t);var o=t.id;this.cateId=o,console.log(this.cateId);t.text;this.showPopup=!1,this.selectSort=t.text},publish:function(){var t=this;this.replyId&&this.replyText?this.appFetch({url:"posts",method:"post",data:{data:{type:"posts",attributes:{replyId:this.replyId,content:this.replyText},relationships:{thread:{data:{type:"threads",id:this.themeId}}}}}}).then((function(e){t.$router.push({path:"details/"+t.themeId})})):this.appFetch({url:"posts",method:"post",data:{data:{type:"posts",attributes:{content:this.replyText},relationships:{thread:{data:{type:"threads",id:this.themeId}}}}}}).then((function(e){t.$router.push({path:"details/"+t.themeId})}))}},(0,n.default)(i,"clearKeywords",(function(){this.keywords="",this.list=[];var t=this.$refs.textarea,e=40/l;t.style.height=e+"rem",e=60/l,t.focus()})),(0,n.default)(i,"backClick",(function(){this.$router.go(-1)})),i)}},egL5:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"post-topic-box"},[o("header",{staticClass:"post-topic-header"},[o("span",{staticClass:"icon iconfont icon-back post-topic-header-icon",on:{click:t.backClick}}),t._v(" "),o("h2",{staticClass:"postHeadTit"},[t._v(t._s(t.headerTitle))]),t._v(" "),o("van-button",{attrs:{type:"primary",size:"mini"},on:{click:t.publish}},[t._v("发布")])],1),t._v(" "),o("div",{staticClass:"post-topic-form"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.replyText,expression:"replyText"}],ref:"textarea",staticClass:"reply-box",attrs:{id:"post-topic-form-text",name:"post-topic",placeholder:"请输入内容",maxlength:t.keywordsMax},domProps:{value:t.replyText},on:{change:t.searchChange,focus:function(e){t.showFacePanel=!1,t.footMove=!1,t.keyboard=!1},input:function(e){e.target.composing||(t.replyText=e.target.value)}}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.uploadShow,expression:"uploadShow"}],staticClass:"uploadBox"},[o("van-uploader",{attrs:{"max-count":12,"after-read":t.handleFile,"before-delete":t.deleteFile,accept:"image/*"},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1)]),t._v(" "),o("footer",{staticClass:"post-topic-footer",class:{footMove:t.footMove},attrs:{id:"post-topic-footer"}},[o("div",{staticClass:"post-topic-footer-left reply-topic-footer-left"},[o("span",{staticClass:"icon iconfont icon-label post-topic-header-icon",class:{"icon-keyboard":t.keyboard},on:{click:t.addExpression}}),t._v(" "),o("span",{staticClass:"icon iconfont icon-picture post-topic-header-icon uploadIcon"},[o("input",{staticClass:"hiddenInput",attrs:{type:"file",accept:"image/*"},on:{change:t.handleFileUp}})])])]),t._v(" "),t.showFacePanel?o("Expression",{staticClass:"expressionBox",attrs:{faceData:t.faceData},on:{onFaceChoose:t.handleFaceChoose}}):t._e()],1)},n=[];o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return n}))},iN0f:function(t,e,o){"use strict";o.r(e);var i=o("xS81"),n=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);e.default=n.a},j2JY:function(t,e,o){"use strict";var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"face-container"},[o("div",{staticClass:"scroll-wrapper"},[o("div",{ref:"faceContent",staticClass:"face-content",style:{width:t.scrollWidth+"px",marginLeft:-t.scrollPosition+"px"},on:{touchmove:function(t){t.preventDefault()}}},t._l(t.faces,(function(e,i){return o("div",{key:i,staticClass:"face-page"},t._l(e,(function(e,i){return o("a",{key:i},[o("img",{staticClass:"emoji",attrs:{src:e._data.url},on:{click:function(o){return t.onFaceClick(" "+e._data.code+" ")}}})])})),0)})),0),t._v(" "),o("div",{staticClass:"page-dot"},t._l(t.faces.length,(function(e){return o("div",{key:e,staticClass:"dot-item",class:e===t.active+1?"active":"",on:{click:function(o){t.active=e-1}}})})),0)])])},n=[];o.d(e,"a",(function(){return i})),o.d(e,"b",(function(){return n}))},uwTP:function(t,e,o){"use strict";o.r(e);var i=o("yaIx"),n=o.n(i);for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);e.default=n.a},xS81:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=s(o("QbLZ"));o("E2jd");var n=s(o("SDcr")),a=s(o("cIj4"));function s(t){return t&&t.__esModule?t:{default:t}}e.default=(0,i.default)({name:"reply-to-topic-view",components:{Expression:n.default}},a.default)},yaIx:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a(o("QbLZ")),n=a(o("6GI9"));function a(t){return t&&t.__esModule?t:{default:t}}o("E2jd"),e.default=(0,i.default)({name:"expressionView"},n.default)}}]);