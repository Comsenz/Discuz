(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{Ap90:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("JZuw")),o=s(i("VVfg"));function s(t){return t&&t.__esModule?t:{default:t}}e.default={data:function(){return{sms:"",newphone:"",bind:"bind",time:1,insterVal:"",isGray:!1,btnContent:"发送验证码",mobileConfirmed:"",backGo:1,disabled:!1,modifyPhone:"",titlePhone:""}},components:{ModifyHeader:n.default},mounted:function(){},created:function(){this.userPhone()},methods:{userPhone:function(){var t=this,e=o.default.getLItem("tokenId");this.appFetch({url:"users",method:"get",splice:"/"+e,data:{include:"wechat"}}).then((function(e){e.errors?t.$toast.fail(e.errors[0].code):(t.modifyPhone=e.readdata._data.originalMobile,console.log(t.modifyPhone))}))},sendSmsCodePhone:function(){var t=this,e=this.newphone;if(e)if(/^((13|14|15|17|18)[0-9]{1}\d{8})$/.test(e)){var i;i=""==this.modifyPhone?"bind":"rebind",this.appFetch({url:"sendSms",method:"post",data:{data:{attributes:{mobile:this.newphone,type:i}}}}).then((function(e){if(e.errors)throw t.$toast.fail(e.errors[0].code+"\n"+e.errors[0].detail),new Error(e.error);t.insterVal=e.data.attributes.interval,t.time=t.insterVal,t.timer()}))}else this.$toast("您输入的手机号码不合法，请重新输入");else this.$toast("请输入手机号码")},timer:function(){if(this.time>1){this.time--,this.btnContent=this.time+"s后重新获取",this.disabled=!0;var t=setTimeout(this.timer,1e3);this.isGray=!0}else 1==this.time&&(this.btnContent="获取验证码",clearTimeout(t),this.disabled=!1,this.isGray=!1)},bindNewPhone:function(){var t=this;if(""!==this.newphone)if(""!==this.sms){var e;e=""==this.modifyPhone?"bind":"rebind",this.appFetch({url:"smsVerify",method:"post",data:{data:{attributes:{mobile:this.newphone,code:this.sms,type:e}}}}).then((function(e){if(e.errors)throw t.$toast.fail(e.errors[0].code),new Error(e.error);t.mobileConfirmed=e.readdata._data.mobileConfirmed,1==t.mobileConfirmed&&(t.$toast("手机号绑定成功"),t.$router.push({path:"/modify-data",query:{backGo:t.backGo}}))})).catch((function(e){t.$toast("手机号绑定失败，请重试")}))}else this.$toast("验证码不能为空");else this.$toast("手机号码不能为空，请重新输入")}},timer:function(){if(this.time>1){this.time--,this.btnContent=this.time+"s后重新获取",this.disabled=!0;var t=setTimeout(this.timer,1e3);this.isGray=!0}else 1==this.time&&(this.btnContent="获取验证码",clearTimeout(t),this.disabled=!1,this.isGray=!1)},beforeRouteEnter:function(t,e,i){i((function(t){"modify-phone"===e.name?t.backGo=-4:t.backGo=-3}))}}},LLQ6:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s(i("QbLZ"));i("llYx"),i("iUmJ");var o=s(i("Ap90"));function s(t){return t&&t.__esModule?t:{default:t}}e.default=(0,n.default)({name:"modify-phone-view"},o.default)},OOvE:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"modify-phone-box"},[i("ModifyHeader",{attrs:{title:"绑定手机号"}}),t._v(" "),i("main",{staticClass:"modify-phone-main content"},[i("div",{staticClass:"modify-phone-form my-info-form"},[i("van-cell-group",[i("van-field",{attrs:{clearable:"",label:"设置新手机",maxlength:"13",placeholder:"请输入新手机号"},model:{value:t.newphone,callback:function(e){t.newphone=e},expression:"newphone"}}),t._v(" "),i("van-field",{attrs:{clearable:"",label:"验证码",placeholder:"请输入验证码"},model:{value:t.sms,callback:function(e){t.sms=e},expression:"sms"}},[i("van-button",{attrs:{slot:"button",size:"small",disabled:t.disabled,type:"default"},on:{click:t.sendSmsCodePhone},slot:"button"},[t._v(t._s(t.btnContent))])],1)],1)],1),t._v(" "),i("div",{staticClass:"modify-phone-operating"},[i("van-button",{attrs:{type:"primary"},on:{click:t.bindNewPhone}},[t._v("提交")])],1)])],1)},o=[];i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o}))},dAVC:function(t,e,i){"use strict";i.r(e);var n=i("OOvE"),o=i("tsbA");for(var s in o)"default"!==s&&function(t){i.d(e,t,(function(){return o[t]}))}(s);var a=i("KHd+"),r=Object(a.a)(o.default,n.a,n.b,!1,null,null,null);e.default=r.exports},llYx:function(t,e,i){},tsbA:function(t,e,i){"use strict";i.r(e);var n=i("LLQ6"),o=i.n(n);for(var s in n)"default"!==s&&function(t){i.d(e,t,(function(){return n[t]}))}(s);e.default=o.a}}]);