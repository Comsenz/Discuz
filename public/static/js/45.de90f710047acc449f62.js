(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{B461:function(e,t,a){"use strict";a.r(t);var r=a("IhNu"),s=a("rkUB");for(var o in s)"default"!==o&&function(e){a.d(t,e,(function(){return s[e]}))}(o);a("rNOx");var n=a("KHd+"),u=Object(n.a)(s.default,r.a,r.b,!1,null,"64cf0d4a",null);t.default=u.exports},IhNu:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"searchBox"},[a("div",{staticClass:"content"},[a("comHeader",{attrs:{title:"我关注的人"}}),e._v(" "),a("form",{attrs:{action:"/"}},[a("van-search",{staticClass:"searchCon",attrs:{placeholder:"搜索用户和主题",background:"#f8f8f8","show-action":""},on:{input:e.onSearch,cancel:e.onCancel},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}})],1),e._v(" "),e.searchResStatus?a("div",{staticClass:"searchRes"},e._l(e.searchUserList,(function(t,r){return a("div",{key:r,staticClass:"resUser"},[t.toUser&&t.toUser._data.avatarUrl?a("img",{staticClass:"resUserHead",attrs:{src:t.toUser._data.avatarUrl},on:{click:function(a){return e.jumpPerDet(t.toUser._data.id)}}}):a("img",{staticClass:"resUserHead",attrs:{src:e.appConfig.staticBaseUrl+"/images/noavatar.gif"},on:{click:function(a){return e.jumpPerDet(t.toUser._data.id)}}}),e._v(" "),a("div",{staticClass:"resUserDet"},[a("span",{staticClass:"resUserName",domProps:{innerHTML:e._s(t.toUser&&t.toUser._data.username.replace(e.searchVal,"<i>"+e.searchVal+"</i>"))}}),e._v(" "),"0"==t._data.is_mutual?a("a",{staticClass:"alreadFollow",attrs:{href:"javascript:;"},on:{click:function(a){return e.followSwitch(t._data.is_mutual,t.toUser._data.id,r)}}},[e._v("已关注")]):"1"==t._data.is_mutual?a("a",{staticClass:"alreadFollow",attrs:{href:"javascript:;"},on:{click:function(a){return e.followSwitch(t._data.is_mutual,t.toUser._data.id,r)}}},[e._v("相互关注")]):a("a",{staticClass:"followHe",attrs:{href:"javascript:;"},on:{click:function(a){return e.followSwitch("2",t.toUser._data.id,r)}}},[e._v("关注TA")])])])})),0):e._e()],1)])},s=[];a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}))},N960:function(e,t,a){},Vzg8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(a("QbLZ")),s=n(a("JZuw")),o=n(a("ynH7"));function n(e){return e&&e.__esModule?e:{default:e}}a("iUmJ"),a("N960"),a("p+Ry"),t.default=(0,r.default)({name:"myCarehView",components:{comHeader:s.default}},o.default)},mjYR:function(e,t,a){},"p+Ry":function(e,t,a){},rNOx:function(e,t,a){"use strict";var r=a("mjYR");a.n(r).a},rkUB:function(e,t,a){"use strict";a.r(t);var r=a("Vzg8"),s=a.n(r);for(var o in r)"default"!==o&&function(e){a.d(t,e,(function(){return r[e]}))}(o);t.default=s.a},ynH7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(a("EJiy")),s=u(a("14Xm")),o=u(a("D3Ub")),n=u(a("VVfg"));function u(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{searchVal:"",userParams:{"filter[type]":"1","page[limit]":20,"page[number]":1,include:"toUser"},firstComeIn:!0,searchResStatus:!1,searchUserList:[],userLoadMoreStatus:!1,themeLoadMoreStatus:!1,userLoadMorePageChange:!1,userLoading:!1,timerSearch:null,searchMaxSum:3,userId:"",oldFollow:!1}},created:function(){this.handleSearchUser();var e="";this.$route.query&&this.$route.query.searchWord&&(e=this.$route.query.searchWord),this.onSearch(e),this.userId=n.default.getLItem("tokenId")},methods:{onSearch:function(e){var t=this;clearTimeout(this.timerSearch),this.searchVal=e,this.timerSearch=setTimeout((function(){t.firstComeIn=!1,t.userParams["filter[username]"]=t.searchVal,t.userParams["page[number]"]=1,t.handleSearchUser(!0)}),200)},onCancel:function(){this.$router.push({path:"/"})},handleSearchUser:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.default)(s.default.mark((function a(){var r;return s.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t&&(e.searchUserList=[]),!e.userLoading){a.next=3;break}return a.abrupt("return");case 3:return e.userLoading=!0,a.prev=4,r=e.userParams["page[number]"],a.next=8,e.appFetch({url:"follow",methods:"get",data:e.userParams}).then((function(t){console.log(t,"dadadada"),e.userLoadMoreStatus=t.readdata.length>e.searchMaxSum,e.searchUserList=t.readdata,e.searchResStatus=!0,console.log(t.readdata[0].toUser._data.avatarUrl,"88997766"),console.log(e.searchUserList[0].toUser._data.username,"2345432")})).catch((function(t){e.userLoadMorePageChange&&e.userParams["page[number]"]>1&&(e.userParams["page[number]"]=r-1)}));case 8:return a.prev=8,e.userLoadMorePageChange=!1,e.userLoading=!1,a.finish(8);case 12:case"end":return a.stop()}}),a,e,[[4,,8,12]])})))()},followSwitch:function(e,t,a){console.log("参数",void 0===e?"undefined":(0,r.default)(e),e);var s=new Object,o="";"0"==e||"1"==e?(s.from_user_id=this.userId,s.to_user_id=t,o="delete",this.oldFollow=e):(s.to_user_id=t,o="post"),this.followRequest(o,s,e,a)},followRequest:function(e,t,a,r){var s=this;this.appFetch({url:"follow",method:e,data:{data:{type:"user_follow",attributes:t}}}).then((function(t){if(t.errors)throw s.$toast.fail(t.errors[0].code),new Error(t.error);"delete"==e?s.searchUserList[r]._data.is_mutual="2":(console.log("post"),s.searchUserList[r]._data.is_mutual=s.oldFollow)}))},jumpPerDet:function(e){this.$router.push({path:"/home-page/"+e})}},mounted:function(){},beforeRouteLeave:function(e,t,a){a()}}}}]);