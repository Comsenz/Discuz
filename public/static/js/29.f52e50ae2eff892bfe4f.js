(window.webpackJsonp=window.webpackJsonp||[]).push([[29,84],{"/Zpk":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{id:1,checked:!0,result:[],checkBoxres:[],imageShow:!1,index:1,themeListResult:[],firstpostImageListResult:[],priview:[],showScreen:[],length:0,indexlist:-1,menuStatus:!1}},props:{themeList:{type:Array},replyTag:{replyTag:!1},isTopShow:{isTopShow:!1},isMoreShow:{isMoreShow:!1},ischeckShow:{ischeckShow:!1}},created:function(){var e=this;this.loadPriviewImgList(),this.forList(),document.addEventListener("click",(function(t){console.log("444");e.$refs.screenDiv;document.contains(t.target)&&(e.indexlist=-1)}))},watch:{themeList:function(e,t){this.themeList=e,this.themeListResult=e,this.loadPriviewImgList(),this.$forceUpdate()},deep:!0},methods:{userArr:function(e){var t=[];return e.forEach((function(e){t.push('<a  href="/home-page/'+e._data.id+'">'+e._data.username+"</a>")})),t.join(",")},forList:function(){},bindScreen:function(e,t){e==this.indexlist?this.indexlist=-1:this.indexlist=e},themeOpera:function(e,t,s,a){console.log(e,t,s,a);var i=new Object;3==t?(i.isEssence=!s,this.themeOpeRequest(e,i,"3",a)):4==t?(i.isSticky=!s,this.themeOpeRequest(e,i,"4",a)):5==t?(i.isDeleted=!0,this.themeOpeRequest(e,i,"5",a)):6==t?this.$router.push({path:"/edit-topic/"+e}):7==t&&this.$router.push({path:"/reply-to-topic/"+e+"/0"})},themeOpeRequest:function(e,t,s,a){var i=this;console.log(e,t,s,a),console.log("7890"),this.appFetch({url:"threads",method:"patch",splice:"/"+e,data:{data:{type:"threads",attributes:t}}}).then((function(e){if(e.errors)throw i.$toast.fail(e.errors[0].code),new Error(e.error);console.log(e),console.log("01234"),"3"==s?(i.essenceStatus=e.readdata._data.isEssence,i.themeList[a]._data.isEssence=i.essenceStatus):"4"==s?(i.stickyStatus=e.readdata._data.isSticky,i.themeList[a]._data.isSticky=i.stickyStatus):"5"==s&&(i.deletedStatus=e.readdata._data.isDeleted,i.themeList.splice(a,1))}))},replyOpera:function(e,t,s){var a=this,i=new Object;i.isLiked=status,this.appFetch({url:"posts",method:"patch",splice:"/"+e,data:{data:{type:"posts",attributes:i}}}).then((function(e){if(e.errors)throw a.$toast.fail(e.errors[0].code),new Error(e.error);a.likedStatus=e.readdata._data.isLiked,a.themeList[s].firstPost._data.isLiked=a.likedStatus,a.$toast.success("修改成功"),a.$emit("changeStatus",!0)}))},loadPriviewImgList:function(){var e=this.themeListResult.length;if(""==this.themeListResult||null==this.themeListResult)return!1;for(var t=0;t<e;t++){var s=[];if(this.themeListResult[t].firstPost.images)for(var a=0;a<this.themeListResult[t].firstPost.images.length;a++)s.push(this.themeListResult[t].firstPost.images[a]._data.thumbUrl);this.themeListResult[t].firstPost.imageList=s}},imageSwiper:function(e){this.loadPriviewImgList(),this.imageShow=!0,console.log(this.priview)},onChange:function(e){this.index=e+1},checkAll:function(){console.log(this.$refs),this.$refs.checkboxGroup.toggleAll(!0)},signOutDele:function(){this.$refs.checkboxGroup.toggleAll()},deleteAllClick:function(){this.$emit("deleteAll",this.result)},jumpThemeDet:function(e,t){t?this.$router.push({path:"/details/"+e}):this.$toast.fail("没有权限，请联系站点管理员")},jumpPerDet:function(e){this.$router.push({path:"/home-page/"+e})}},mounted:function(){document.addEventListener("click",this.disappear,!1)},destroyed:function(){document.addEventListener("click",this.disappear,!1)},beforeRouteLeave:function(e,t,s){s()}}},"1pAk":function(e,t,s){"use strict";s.r(t);var a=s("7ABT"),i=s.n(a);for(var r in a)"default"!==r&&function(e){s.d(t,e,(function(){return a[e]}))}(r);t.default=i.a},"3lFi":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(s("14Xm")),i=r(s("D3Ub"));function r(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{serHide:!0,serShow:!1,searchVal:"",searchThemeList:[],themeLoadMorePageChange:!1,loading:!1,finished:!1,isLoading:!1,pageIndex:1,offset:100,immediateCheck:!1,pageLimit:20,searchTimer:null}},created:function(){var e="";this.$route.query&&this.$route.query.searchWord&&(e=this.$route.query.searchWord),this.onSearch(e)},methods:{serToggle:function(){this.serHide=!1,this.serShow=!0,this.$refs.serInp.focus()},onSearch:function(e){var t=this;clearTimeout(this.searchTimer),this.searchVal=e,this.pageIndex=1,this.searchTimer=setTimeout((function(){t.handleSearchUser(!0)}),220)},onCancel:function(){},handleSearchUser:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,i.default)(a.default.mark((function s(){return a.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,e.appFetch({url:"searchThreads",method:"get",data:{include:["user","firstPost","firstPost.images","lastThreePosts","lastThreePosts.user","lastThreePosts.replyUser","firstPost.likedUsers","rewardedUsers"],"filter[username]":e.searchVal.trim(),"page[number]":e.pageIndex,"page[limit]":e.pageLimit}}).then((function(s){if(s.errors)throw e.$toast.fail(s.errors[0].code),new Error(s.error);t&&(e.searchThemeList=[]),e.loading=!1,e.searchThemeList=e.searchThemeList.concat(s.readdata),e.finished=s.readdata.length<e.pageLimit})).catch((function(t){e.loading&&1!==e.pageIndex&&e.pageIndex--}));case 3:return s.prev=3,e.themeLoadMorePageChange=!1,e.loading=!1,s.finish(3);case 7:case"end":return s.stop()}}),s,e,[[0,,3,7]])})))()},handleLoadMoreUser:function(){this.themeLoadMorePageChange=!0,this.handleSearchUser()},onLoad:function(){this.loading=!0,this.pageIndex++,this.handleSearchUser()},onRefresh:function(){var e=this;this.pageIndex=1,this.handleSearchUser(!0).then((function(){e.$toast("刷新成功"),e.isLoading=!1,e.finished=!1})).catch((function(t){e.$toast("刷新失败"),e.isLoading=!1}))},headerBack:function(){this.$router.go(-1)},jumpPerDet:function(e){console.log("跳转到个人主页"),this.$router.push({path:"/home-page/"+e})}},mounted:function(){},beforeRouteLeave:function(e,t,s){s()}}},"7ABT":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(s("QbLZ"));s("Cpqr");var i=n(s("3lFi")),r=n(s("CFQY"));function n(e){return e&&e.__esModule?e:{default:e}}s("E2jd"),t.default=(0,a.default)({name:"themeSearchView",components:{ThemeDet:r.default}},i.default)},CFQY:function(e,t,s){"use strict";s.r(t);var a=s("oLKa"),i=s("DhNJ");for(var r in i)"default"!==r&&function(e){s.d(t,e,(function(){return i[e]}))}(r);var n=s("KHd+"),o=Object(n.a)(i.default,a.a,a.b,!1,null,null,null);t.default=o.exports},Cpqr:function(e,t,s){},DhNJ:function(e,t,s){"use strict";s.r(t);var a=s("xry+"),i=s.n(a);for(var r in a)"default"!==r&&function(e){s.d(t,e,(function(){return a[e]}))}(r);t.default=i.a},Q8hK:function(e,t,s){"use strict";s.r(t);var a=s("p1Dc"),i=s("1pAk");for(var r in i)"default"!==r&&function(e){s.d(t,e,(function(){return i[e]}))}(r);s("SilF");var n=s("KHd+"),o=Object(n.a)(i.default,a.a,a.b,!1,null,"527449d4",null);t.default=o.exports},SilF:function(e,t,s){"use strict";var a=s("v+t8");s.n(a).a},oLKa:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[s("div",[s("van-checkbox-group",{ref:"checkboxGroup",model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[e._l(e.themeList,(function(t,a){return s("div",{key:a},[s("div",{staticClass:"cirPostCon"},[s("div",{},[s("div",{staticClass:"postTop"},[s("div",{staticClass:"postPer"},[t.user&&t.user._data.avatarUrl?s("img",{staticClass:"postHead",attrs:{src:t.user._data.avatarUrl},on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}}):s("img",{staticClass:"postHead",attrs:{src:e.appConfig.staticBaseUrl+"/images/noavatar.gif"},on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}}),e._v(" "),s("div",{staticClass:"perDet"},[t.user?s("div",{staticClass:"perName",on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}},[e._v(e._s(t.user._data.username))]):s("div",{staticClass:"perName"},[e._v("该用户已被删除")]),e._v(" "),s("div",{staticClass:"postTime"},[e._v(e._s(e.$moment(t._data.createdAt).format("YYYY-MM-DD HH:mm")))])])]),e._v(" "),s("div",{staticClass:"postOpera"},[t._data.isSticky?s("span",{directives:[{name:"show",rawName:"v-show",value:e.isTopShow,expression:"isTopShow"}],staticClass:"icon iconfont icon-top"}):e._e(),e._v(" "),e.isMoreShow&&(t._data.canEssence||t._data.canSticky||t._data.canDelete||t._data.canEdit||t.firstPost._data.canLike)?s("div",{ref:"screenDiv",refInFor:!0,staticClass:"screen",on:{click:function(t){return t.stopPropagation(),e.bindScreen(a,t)}}},[s("div",{staticClass:"moreCli"},[s("span",{staticClass:"icon iconfont icon-more"})]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.indexlist==a,expression:"indexlist==index"}],staticClass:"themeList"},[t.firstPost._data.canLike&&t.firstPost._data.isLiked?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.replyOpera(t.firstPost._data.id,2,t.firstPost._data.isLiked,a)}}},[e._v("取消点赞")]):e._e(),e._v(" "),t.firstPost._data.canLike&&!t.firstPost._data.isLiked?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.replyOpera(t.firstPost._data.id,2,t.firstPost._data.isLiked,a)}}},[e._v("点赞")]):e._e(),e._v(" "),t._data.canEssence&&t._data.isEssence?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,3,t._data.isEssence,a)}}},[e._v("取消加精")]):e._e(),e._v(" "),t._data.canEssence&&!t._data.isEssence?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,3,t._data.isEssence,a)}}},[e._v("加精")]):e._e(),e._v(" "),t._data.canSticky&&t._data.isSticky?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,4,t._data.isSticky,a)}}},[e._v("取消置顶")]):e._e(),e._v(" "),t._data.canSticky&&!t._data.isSticky?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,4,t._data.isSticky,a)}}},[e._v("置顶")]):e._e(),e._v(" "),t.firstPost._data.canEdit?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,6)}}},[e._v("编辑")]):e._e(),e._v(" "),t._data.canReply?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,7)}}},[e._v("回复")]):e._e(),e._v(" "),t._data.canDelete?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.themeOpera(t._data.id,5)}}},[e._v("删除")]):e._e()])]):e._e()])]),e._v(" "),t.firstPost?s("div",{staticClass:"postContent"},[s("a",{domProps:{innerHTML:e._s(t.firstPost._data.contentHtml)},on:{click:function(s){return e.jumpThemeDet(t._data.id,t._data.canViewPosts)}}})]):e._e(),e._v(" "),t.firstPost.imageList&&t.firstPost.imageList.length>0?s("div",{staticClass:"themeImgBox",on:{click:function(s){return e.jumpThemeDet(t._data.id,t._data.canViewPosts)}}},[s("div",{staticClass:"themeImgList moreImg"},e._l(t.firstPost.imageList,(function(t,a){return a<9?s("van-image",{key:a,staticClass:"themeImgChild",attrs:{fit:"cover","lazy-load":"",src:t}}):e._e()})),1)]):e._e()]),e._v(" "),s("div",{staticClass:"operaBox"},[t.firstPost.likedUsers.length>0||t.rewardedUsers.length>0?s("div",{staticClass:"isrelationGap"}):e._e(),e._v(" "),t.firstPost.likedUsers.length>0?s("div",{staticClass:"likeBox"},[s("span",{staticClass:"icon iconfont icon-praise-after"}),e._v(" "),s("span",{domProps:{innerHTML:e._s(e.userArr(t.firstPost.likedUsers))}}),e._v(" "),t.firstPost._data.likeCount>10?s("i",[e._v(" 等"),s("span",[e._v(e._s(t.firstPost._data.likeCount))]),e._v("个人觉得很赞")]):e._e()]):e._e(),e._v(" "),t.rewardedUsers.length>0?s("div",{staticClass:"reward"},[s("span",{staticClass:"icon iconfont icon-money"}),e._v(" "),s("span",{domProps:{innerHTML:e._s(e.userArr(t.rewardedUsers))}})]):e._e(),e._v(" "),t.lastThreePosts.length>0&&t.firstPost.likedUsers.length>0||t.lastThreePosts.length>0&&t.rewardedUsers.length>0?s("div",{staticClass:"isrelationLine"}):e._e(),e._v(" "),t.lastThreePosts.length>0?s("div",{staticClass:"replyBox"},[e._l(t.lastThreePosts,(function(t){return s("div",{staticClass:"replyCon"},[t.user?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}},[e._v(e._s(t.user._data.username))]):s("a",{attrs:{href:"javascript:;"}},[e._v("该用户已被删除")]),e._v(" "),t._data.replyUserId?s("span",{staticClass:"font9",on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}},[e._v("回复")]):e._e(),e._v(" "),t._data.replyUserId&&t.replyUser?s("a",{attrs:{href:"javascript:;"},on:{click:function(s){return e.jumpPerDet(t.user._data.id)}}},[e._v(e._s(t.replyUser._data.username))]):t._data.replyUserId&&!t.replyUser?s("a",{attrs:{href:"javascript:;"}},[e._v("该用户已被删除")]):e._e(),e._v(" "),s("span",{domProps:{innerHTML:e._s(t._data.contentHtml)}})])})),e._v(" "),t._data.postCount>4?s("a",{staticClass:"allReply",on:{click:function(s){return e.jumpThemeDet(t._data.id,t._data.canViewPosts)}}},[e._v("全部"+e._s(t._data.postCount-1)+"条回复"),s("span",{staticClass:"icon iconfont icon-right-arrow"})]):e._e()],2):e._e()]),e._v(" "),e.ischeckShow?s("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"memberCheck",attrs:{name:t._data.id}}):e._e()],1),e._v(" "),s("div",{staticClass:"gap"})])})),e._v(" "),e.ischeckShow?s("div",{staticClass:"manageFootFixed choFixed"},[s("a",{attrs:{href:"javascript:;"},on:{click:e.checkAll}},[e._v("全选")]),e._v(" "),s("a",{attrs:{href:"javascript:;"},on:{click:e.signOutDele}},[e._v("取消全选")]),e._v(" "),s("button",{staticClass:"checkSubmit",on:{click:e.deleteAllClick}},[e._v("删除选中")])]):e._e()],2)],1),e._v(" "),s("van-image-preview",{attrs:{images:e.priview},on:{change:e.onChange},scopedSlots:e._u([{key:"index",fn:function(){return[e._v("第"+e._s(e.index)+"页")]},proxy:!0}]),model:{value:e.imageShow,callback:function(t){e.imageShow=t},expression:"imageShow"}})],1)},i=[];s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}))},p1Dc:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"foueHeadBox"},[s("div",{staticClass:"fourHeader",attrs:{headFixed:"true"}},[s("span",{staticClass:"icon iconfont icon-back headBack",on:{click:e.headerBack}}),e._v(" "),s("h1",{staticClass:"headTit"},[e._v(e._s(e.$route.meta.title))])]),e._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:e.serHide,expression:"serHide"}],staticClass:"serBox",on:{click:e.serToggle}},[s("input",{staticClass:"serInp",attrs:{type:"text",name:"",placeholder:"搜索"}}),e._v(" "),s("i",{staticClass:"icon iconfont icon-search"})]),e._v(" "),s("form",{attrs:{action:"/"}},[s("van-search",{directives:[{name:"show",rawName:"v-show",value:e.serShow,expression:"serShow"}],ref:"serInp",staticClass:"searchCon",attrs:{placeholder:"搜索主题",background:"#f8f8f8","show-action":""},on:{input:e.onSearch,cancel:e.onCancel},model:{value:e.searchVal,callback:function(t){e.searchVal=t},expression:"searchVal"}})],1)]),e._v(" "),s("van-list",{attrs:{finished:e.finished,"finished-text":"没有更多了",offset:e.offset},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[s("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[s("ThemeDet",{attrs:{themeList:e.searchThemeList}})],1)],1)],1)},i=[];s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return i}))},"v+t8":function(e,t,s){},"xry+":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(s("QbLZ")),i=r(s("/Zpk"));function r(e){return e&&e.__esModule?e:{default:e}}s("E2jd"),t.default=(0,a.default)({name:"themeDetView"},i.default)}}]);