(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{"2AiC":function(e,a,t){"use strict";t.r(a);var s=t("gdl1"),r=t("IuSB");for(var n in r)"default"!==n&&function(e){t.d(a,e,(function(){return r[e]}))}(n);t("LG1r");var i=t("KHd+"),c=Object(i.a)(r.default,s.a,s.b,!1,null,"4e105c34",null);a.default=c.exports},"2NB6":function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=n(t("14Xm")),r=n(t("D3Ub"));function n(e){return e&&e.__esModule?e:{default:e}}a.default={data:function(){return{searchVal:"",userParams:{"filter[name]":"","filter[id]":"写获取到的用户id","filter[group_id]":[],"filter[bind]":1,"page[limit]":2,"page[number]":1,sort:"-createdAt",include:"groups"},themeParamd:{"filter[q]":"","page[limit]":2,"page[number]":1},searchUserList:[],searchThemeList:[],userLoadMoreStatus:!0,themeLoadMoreStatus:!0,userLoadMorePageChange:!1,themeLoadMorePageChange:!1}},methods:{onSearch:function(e){if(this.searchVal=e,""===this.searchVal)return this.searchUserList=[],void(this.searchThemeList=[]);console.log(e,"value"),this.userParams={"filter[name]":this.searchVal,"filter[id]":1,"filter[group_id]":[],"filter[bind]":1,"page[limit]":2,"page[number]":1,sort:"-createdAt",include:"groups"},this.handleSearchUser(!0),this.themeParamd={"filter[q]":this.searchVal,"page[limit]":2,"page[number]":1},this.handleSearchTheme(!0)},onCancel:function(){},handleSearchUser:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,r.default)(s.default.mark((function t(){var r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a&&(e.searchUserList=[]),t.prev=1,r=e.userParams["page[number]"],t.next=5,e.appFetch({url:"users",methods:"get",data:{currentPageNum:e.userParams}}).then((function(a){e.searchUserList=e.searchUserList.concat(a.readdata),e.userLoadMoreStatus=a.length>e.userParams["page[limit]"],console.log(a.readdata[0]._data.username,"user list data"),console.log(a.readdata[0])})).catch((function(a){e.userLoadMorePageChange&&e.userParams["page[number]"]>1&&(e.userParams["page[number]"]=r-1)}));case 5:return t.prev=5,e.userLoadMorePageChange=!1,t.finish(5);case 8:case"end":return t.stop()}}),t,e,[[1,,5,8]])})))()},handleLoadMoreUser:function(){this.userParams["page[number]"]++,this.userLoadMorePageChange=!0,this.handleSearchUser()},handleSearchTheme:function(){var e=this,a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,r.default)(s.default.mark((function t(){var r;return s.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a&&(e.searchThemeList=[]),t.prev=1,r=e.themeParamd["page[number]"],t.next=5,e.appFetch({url:"searchThreads",method:"get",data:{currentPageNum:e.themeParamd}}).then((function(a){e.searchThemeList=e.searchThemeList.concat(a.readdata),e.themeLoadMoreStatus=a.readdata.length>e.themeParamd["page[limit]"],console.log(e.searchThemeList,"11111111111111111111111")})).catch((function(a){e.themeLoadMorePageChange&&e.themeParamd["page[number]"]>1&&(e.themeParamd["page[number]"]=r-1)}));case 5:return t.prev=5,e.themeLoadMorePageChange=!1,t.finish(5);case 8:case"end":return t.stop()}}),t,e,[[1,,5,8]])})))()},handleLoadMoreTheme:function(){this.themeParamd["page[number]"]++,this.themeLoadMorePageChange=!0,this.handleSearchTheme()}},mounted:function(){},beforeRouteLeave:function(e,a,t){}}},IuSB:function(e,a,t){"use strict";t.r(a);var s=t("ZxSw"),r=t.n(s);for(var n in s)"default"!==n&&function(e){t.d(a,e,(function(){return s[e]}))}(n);a.default=r.a},LG1r:function(e,a,t){"use strict";var s=t("WXfT");t.n(s).a},WXfT:function(e,a,t){},ZxSw:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=n(t("QbLZ"));t("E2jd");var r=n(t("2NB6"));function n(e){return e&&e.__esModule?e:{default:e}}a.default=(0,s.default)({name:"searchView"},r.default)},gdl1:function(e,a,t){"use strict";var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"searchBox"},[t("form",{attrs:{action:"/"}},[t("van-search",{staticClass:"searchCon",attrs:{placeholder:"搜索用户和主题",background:"#f8f8f8","show-action":""},on:{input:e.onSearch,cancel:e.onCancel},model:{value:e.searchVal,callback:function(a){e.searchVal=a},expression:"searchVal"}})],1),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.searchUserList.length>0,expression:"searchUserList.length > 0"}],staticClass:"searchRes"},[t("h2",{staticClass:"resultTit"},[e._v("用户")]),e._v(" "),e._l(e.searchUserList,(function(a,s){return t("div",{key:s,staticClass:"resUser"},[t("img",{staticClass:"resUserHead",attrs:{src:e.appConfig.staticBaseUrl+"/images/noavatar.gif"}}),e._v(" "),t("div",{staticClass:"resUserDet"},[t("span",{staticClass:"resUserName",domProps:{innerHTML:e._s(a._data.username.replace(e.searchVal,"<i>"+e.searchVal+"</i>"))}})])])})),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.userLoadMoreStatus,expression:"userLoadMoreStatus"}],staticClass:"searchMore",on:{click:e.handleLoadMoreUser}},[t("i",{staticClass:"icon iconfont icon-search"}),e._v("\n      搜索更多用户\n    ")])],2),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.searchThemeList.length>0,expression:"searchThemeList.length > 0"}],staticClass:"gap"}),e._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:e.searchThemeList.length>0,expression:"searchThemeList.length > 0"}],staticClass:"searchRes"},[t("h2",{staticClass:"resultTit"},[e._v("主题")]),e._v(" "),e._l(e.searchThemeList,(function(a,s){return t("div",{key:s,staticClass:"themeRes"},[t("div",{staticClass:"postTop"},[t("div",{staticClass:"postPer"},[t("img",{staticClass:"postHead",attrs:{src:e.appConfig.staticBaseUrl+"/images/noavatar.gif"}}),e._v(" "),t("div",{staticClass:"perDet"},[t("div",{staticClass:"perName"},[e._v(e._s(a._data.title))]),e._v(" "),t("div",{staticClass:"postTime"},[e._v(e._s(e.$moment(a._data.createdAt).startOf("hour").fromNow()))])])])]),e._v(" "),t("div",{staticClass:"postContent"},[t("a",{attrs:{href:"javascript:;"}},[e._v(e._s(a.firstPost._data&&a.firstPost._data.content))])])])})),e._v(" "),t("div",{staticClass:"searchMore",on:{click:e.handleLoadMoreTheme}},[t("i",{staticClass:"icon iconfont icon-search"}),e._v("\n      搜索更多用户\n    ")])],2)])},r=[];t.d(a,"a",(function(){return s})),t.d(a,"b",(function(){return r}))}}]);