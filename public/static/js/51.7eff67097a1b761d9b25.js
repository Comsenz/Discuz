(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{"+8Zf":function(e,t,a){},"1dvN":function(e,t,a){"use strict";var s=a("+8Zf");a.n(s).a},"4psX":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r=i(a("14Xm")),n=i(a("D3Ub"));function i(e){return e&&e.__esModule?e:{default:e}}t.default={data:function(){return{result:[],checkList:[],userList:[],choiceShow:!1,checkOperaStatus:!1,choList:[],searchName:"",userParams:{"filter[username]":"","page[limit]":20,"page[number]":0},userLoadMoreStatus:!1,userLoadMorePageChange:!1,choiceRes:{attributes:{name:"选择操作"}},loading:!1,finished:!1,isLoading:!1,pageSize:"",pageIndex:1,offset:100,searchTimeout:null,serHide:!0,serShow:!1}},created:(s=(0,n.default)(r.default.mark((function e(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOperaType();case 2:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)}),methods:{serToggle:function(){this.serHide=!1,this.serShow=!0,this.$refs.serInp.focus()},onCancel:function(){},toggle:function(e){var t=this.userList.length;if(0!==t){for(var a=[],s=0;s<t;s++){this.userList[s]._data.id===e&&(this.userList[s].checkStatus=!this.userList[s].checkStatus),this.userList[s].checkStatus&&a.push(this.userList[s]._data.username)}this.result=a}},showChoice:function(){this.choiceShow=!this.choiceShow},setSelectVal:function(e){this.choiceShow=!1,this.checkOperaStatus=!0,this.choiceRes=e},handleSearch:function(e){var t=this;this.searchName=e||"",this.userParams={"filter[username]":this.searchName,"page[limit]":15,"page[number]":1},clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout((function(){t.getSearchValUserList(!0)}),300)},getSearchValUserList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,n.default)(r.default.mark((function a(){var s,n;return r.default.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,e.appFetch({method:"get",url:"users",data:e.userParams});case 3:if(!(s=a.sent).errors){a.next=9;break}throw e.$toast.fail(s.errors[0].code),new Error(s.error);case 9:t&&(e.userList=[]),e.userList=e.userList.concat(s.readdata).map((function(e,t){var a=e;return a.checkStatus=!1,a})),e.finished=s.readdata.length<e.userParams["page[limit]"];case 12:a.next=19;break;case 14:a.prev=14,a.t0=a.catch(0),console.error(a.t0,"membersManagementCon.js getSearchValUserList"),n=e.userParams["page[number]"],e.userLoadMorePageChange&&e.userParams["page[number]"]>1&&(e.userParams["page[number]"]=n-1);case 19:return a.prev=19,e.userLoadMorePageChange=!1,a.finish(19);case 22:case"end":return a.stop()}}),a,e,[[0,14,19,22]])})))()},getOperaType:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.appFetch({url:"groups",method:"get"});case 3:if(!(a=t.sent).errors){t.next=9;break}throw e.$toast.fail(a.errors[0].code),new Error(a.error);case 9:e.choList=a.data;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),console.error(t.t0,"membersManagementCon.js getOperaType");case 15:return t.prev=15,t.finish(15);case 17:case"end":return t.stop()}}),t,e,[[0,12,15,17]])})))()},handleSubmit:function(){var e=this;return(0,n.default)(r.default.mark((function t(){var a,s,n,i,o;return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.checkOperaStatus){t.next=4;break}return e.$toast("未选择操作类型"),t.abrupt("return");case 4:if(0!==e.result.length){t.next=7;break}return e.$toast("未选择用户"),t.abrupt("return");case 7:for(a=[],s=e.choiceRes.id,n=0,i=e.userList.length;n<i;n++)e.userList[n].checkStatus&&a.push({attributes:{id:e.userList[n]._data.id,groupId:s}});return t.next=12,e.appFetch({url:"users",method:"PATCH",data:{data:a}});case 12:if(!(o=t.sent).errors){t.next=18;break}throw e.$toast.fail(o.errors[0].code),new Error(o.error);case 18:e.result=[],e.userParams["page[number]"]=1,console.log("我变啦啦啦"),e.getSearchValUserList(!0);case 22:t.next=28;break;case 24:t.prev=24,t.t0=t.catch(0),console.error(t.t0,"handleSubmit error"),e.$toast("修改成员状态失败");case 28:case"end":return t.stop()}}),t,e,[[0,24]])})))()},onLoad:function(){var e=this;return(0,n.default)(r.default.mark((function t(){return r.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("onLoad"),e.userLoadMorePageChange=!0,e.loading=!0,e.userParams["page[number]"]++,t.next=7,e.getSearchValUserList();case 7:t.next=11;break;case 9:t.prev=9,t.t0=t.catch(0);case 11:return t.prev=11,e.loading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,e,[[0,9,11,14]])})))()},onRefresh:function(){this.userParams["page[number]"]=1,this.result=[],this.getSearchValUserList(!0),this.$toast("刷新成功"),this.isLoading=!1,this.finished=!1},headerBack:function(){this.$router.go(-1)}},mounted:function(){},beforeRouteLeave:function(e,t,a){a()}}},"6jfs":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"foueHeadBox"},[a("div",{staticClass:"fourHeader"},[a("span",{staticClass:"icon iconfont icon-back headBack",on:{click:e.headerBack}}),e._v(" "),a("h1",{staticClass:"headTit"},[e._v(e._s(e.$route.meta.title))])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.serHide,expression:"serHide"}],staticClass:"serBox"},[a("input",{staticClass:"serInp",attrs:{type:"text",name:"",placeholder:"搜索"},on:{click:e.serToggle}})]),e._v(" "),a("form",{attrs:{action:"/"}},[a("van-search",{directives:[{name:"show",rawName:"v-show",value:e.serShow,expression:"serShow"}],ref:"serInp",staticClass:"searchCon",attrs:{placeholder:"搜索用户",background:"#f8f8f8","show-action":""},on:{input:e.handleSearch,cancel:e.onCancel},model:{value:e.searchName,callback:function(t){e.searchName=t},expression:"searchName"}})],1)]),e._v(" "),a("van-list",{attrs:{finished:e.finished,offset:e.offset,"finished-text":"没有更多了"},on:{load:e.onLoad},model:{value:e.loading,callback:function(t){e.loading=t},expression:"loading"}},[a("van-pull-refresh",{on:{refresh:e.onRefresh},model:{value:e.isLoading,callback:function(t){e.isLoading=t},expression:"isLoading"}},[a("div",{staticClass:"searchRes memberCheckList"},[a("van-checkbox-group",{model:{value:e.result,callback:function(t){e.result=t},expression:"result"}},[a("van-cell-group",e._l(e.userList,(function(t){return a("van-cell",{key:t._data.username,staticClass:"resUser",attrs:{clickable:""},on:{click:function(a){return e.toggle(t._data.id)}}},[t._data.avatarUrl?a("img",{staticClass:"resUserHead",attrs:{src:t._data.avatarUrl,alt:""}}):a("img",{staticClass:"resUserHead",attrs:{src:e.appConfig.staticBaseUrl+"/images/noavatar.gif"}}),e._v(" "),a("div",{staticClass:"resUserDet"},[a("span",{staticClass:"resUserName"},[e._v(e._s(t._data.username))]),e._v(" "),a("span",{staticClass:"userRole"},[e._v(e._s(t.groups[0]&&t.groups[0]._data.name))]),e._v(" "),a("van-checkbox",{ref:"checkboxes",refInFor:!0,staticClass:"memberCheck",attrs:{slot:"right-icon",name:t._data.username},slot:"right-icon"})],1)])})),1)],1)],1)])],1),e._v(" "),a("div",{staticClass:"manageFootFixed"},[a("div",{staticClass:"operaCho"},[a("div",{staticClass:"operaWo",on:{click:e.showChoice}},[a("span",[e._v(e._s(e.choiceRes.attributes.name))]),e._v(" "),a("i",{staticClass:"icon iconfont icon-choice-item"})]),e._v(" "),e.choiceShow?a("ul",{staticClass:"operaChoList"},e._l(e.choList,(function(t){return a("li",{key:t.id,staticClass:"operaChoLi",on:{click:function(a){return a.stopPropagation(),e.setSelectVal(t)}}},[e._v(e._s(t.attributes.name))])})),0):e._e()]),e._v(" "),a("button",{staticClass:"checkSubmit",on:{click:e.handleSubmit}},[e._v("提交")])])],1)},r=[];a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return r}))},NrFY:function(e,t,a){"use strict";a.r(t);var s=a("6jfs"),r=a("fKpU");for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);a("1dvN");var i=a("KHd+"),o=Object(i.a)(r.default,s.a,s.b,!1,null,"3719e8d0",null);t.default=o.exports},"Y+eA":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=n(a("QbLZ")),r=n(a("4psX"));function n(e){return e&&e.__esModule?e:{default:e}}a("E2jd"),t.default=(0,s.default)({name:"managementCirclesView",components:{}},r.default)},fKpU:function(e,t,a){"use strict";a.r(t);var s=a("Y+eA"),r=a.n(s);for(var n in s)"default"!==n&&function(e){a.d(t,e,(function(){return s[e]}))}(n);t.default=r.a}}]);